<!DOCTYPE html>
<html>
  <head>
    <title>JSON</title>
    <link href="css/main.css" rel="stylesheet">
  </head>

  <body>
    <div id="app">
      <div class="side-top">JSON</div>
      
      <div class="side-left">
        <textarea  v-model="jsoncon"></textarea>
      </div>

      <div class="side-right">
        <vue-outer :jsondata="jsonhtml"></vue-outer>
      </div>

    </div>     

    <!--最外层根结构-->
    <script type="text/x-template" id="outer-template">
      <ul class="json-item">
        <vue-val  :val="jsondata"></vue-val>
      </ul>
    </script>


    <!--内层每个键值对-->
    <script type="text/x-template" id="item-template">
      <ul class="json-item">
        <vue-val :field="key" :val="val" v-for="(val, key) in jsondata"></vue-val>
      </ul>
    </script>

    <!--key value 最终的渲染方式-->
    <script type="text/x-template" id="val-template">
      <div class="keyval">
        <template v-if="!isObjectArr(val)">
          <span class="key">"{{field}}": </span>
          <span  v-bind:class="'val val-' + getTyp(val)">{{formatVal(val)}},</span>
        </template>


        <!--key + 展开折叠ICON-->
        <template v-if="isObjectArr(val)">
          <span class="key" v-show="field">"{{field}}": </span>
          <vue-expand></vue-expand>
        </template>


        <!--值为对象时-->
        <template v-if="getTyp(val) == 'Object'">
          <span class="expand-view">
            <span>{</span>
            <vue-item :jsondata="val"></vue-item>
            <div class="brace-end">},</div>
          </span>  

          <span class="fold-view">{{getTyp(val)}}{<label class="ex-alia" @click="expand($event)">...</label>},</span>
        </template>


        <!--值为数组时-->
        <template v-if="getTyp(val) == 'Array'">
          <span class="expand-view">
            <span>[</span>
            <span class="val">
              <vue-outer :jsondata="sub" v-for="sub in val"></vue-outer>
            </span> 
            <div class="brace-end">],</div>
          </span>  

          <span class="fold-view">{{getTyp(val)}}[<label class="arrlen ex-alia" @click="expand($event)">{{val.length}}</label>],</span>

        </template>
      </div>
    </script>

    
    <!--展开 折叠的 UI 组件-->
    <script type="text/x-template" id="expand-template">
      <span class="expand-wraper">
        <svg class="icon icon-square icon-square-min" @click="fold($event)">
          <use xlink:href="svg/icon.svg#minus-square"></use>
        </svg>

        <svg class="icon icon-square icon-square-plus" @click="expand($event)" >
          <use xlink:href="svg/icon.svg#plus-square"></use>
        </svg>
      </span>
    </script>

    

    <script src="js/vue.min.js"></script>
    <script src="js/jquery.js"></script>
    <script src="js/parse.js"></script>
    <script src="js/main.js"></script>
  </body>
</html>